<!doctype html>
<html>
<head>
<meta charset="utf-8">
</head>
<body>
<div id="monitor"><h1>Connecting...</h1></div><br>
<div id="info"></div><br>
<div id="smart"></div>
<script src="jbog_client.js"></script>
<script>
function $(element) {
  return document.querySelector(element);
}

function main() {
  function update_monitor(hw) {
    $("#monitor").innerHTML = JSON.stringify(hw, undefined, 2);
  }

  function update_info(hw) {
    $("#info").innerHTML = JSON.stringify(hw, undefined, 2);
  }

  function update_smart(hw) {
    $("#smart").innerHTML = JSON.stringify(hw, undefined, 2);
  }

  var client_data;

  var jbog = jbog_client.make();

  jbog.on("client_data", function (data) {
    if (client_data === undefined) {
      client_data = data;
    } else {
      jbog.send_message("set_client_data", client_data);
    }
    jbog.repeat_message("get_monitor_data");
    jbog.send_message("get_info_data");
    jbog.send_message("get_smart_data");
    jbog.on("monitor_data", update_monitor);
    jbog.on("info_data", update_info);
    jbog.on("smart_data", update_smart);
  });

  jbog.run("127.0.0.1", 8000);
}

main();

</script>
</body>
</html>
